<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cn.teleinfo.bidadmin.blockchain.mapper.BidDocumentAttrMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="bidDocumentAttrResultMap" type="cn.teleinfo.bidadmin.blockchain.entity.BidDocumentAttr">
        <id column="id" property="id"/>
        <result column="Type" property="type"/>
        <result column="value" property="value"/>
        <result column="owner" property="owner"/>
    </resultMap>

    <select id="selectBidDocumentAttrPage" resultMap="bidDocumentAttrResultMap">
        select * from bid_document_attr where is_deleted = 0
    </select>

    <select id="findDocumentAttrByOwnerType" resultMap="bidDocumentAttrResultMap">
        select * from bid_document_attr
        <where>
            <if test="owner != null and owner != ''">
                owner=${owner}
            </if>
            <if test="Type != null and Type != ''">
                Type=${Type}
            </if>
        </where>
    </select>

    <insert id="saveDocumentAttr" parameterType="cn.teleinfo.bidadmin.blockchain.entity.BidDocumentAttr">
        INSERT INTO bid_document_attr(`Type`, `value`, owner)
        VALUES (#{Type},#{value},#{owner})
    </insert>

    <update id="updateDocumentAttr" parameterType="cn.teleinfo.bidadmin.blockchain.entity.BidDocumentAttr">
        UPDATE bid_document_attr
        <trim prefix="SET" suffixOverrides=",">
            <if test="null != value and '' != value">
                `value` = #{value}
            </if>
        </trim>
        WHERE `Type` = #{Type} and owner = #{owner} and id = #{id}
    </update>

    <insert id="saveBatchDocumentAttrs" parameterType="list">
        insert into bid_document_attr(`Type`, `value`, owner)
        <foreach collection="list" item="item" open="values" separator=",">
            (#{item.type},#{item.value},#{item.owner})
        </foreach>
        ON duplicate KEY UPDATE
        `Type`=VALUES(`Type`),
        `value`=VALUES(`value`)
    </insert>
</mapper>
